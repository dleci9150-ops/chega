(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[300],{3454:function(e,t,n){"use strict";var o,r;e.exports=(null==(o=n.g.process)?void 0:o.env)&&"object"==typeof(null==(r=n.g.process)?void 0:r.env)?n.g.process:n(7663)},7909:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/agendar-updated",function(){return n(2197)}])},2197:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Agendar}});var o=n(5893),r=n(7294),a=n(7185),l=n(3120),s=n(6398),i=n(8717);n(8281);var c=n(3454);function Agendar(){let[e,t]=(0,r.useState)(1),[n,u]=(0,r.useState)(null),[d,m]=(0,r.useState)([]),[f,p]=(0,r.useState)(""),[h,x]=(0,r.useState)(""),[b,g]=(0,r.useState)(""),[v,j]=(0,r.useState)([]),[y,T]=(0,r.useState)(null),[w,N]=(0,r.useState)(""),[_,k]=(0,r.useState)(!1),handleSubmit=async()=>{try{var e,o;if(k(!0),!n||!d.length||!f||!b){alert("⚠️ Por favor, preencha todos os campos obrigat\xf3rios"),k(!1);return}let r={userId:1,serviceId:(null===(e=d[0])||void 0===e?void 0:e.id)||1,date:n,time:"10:00",address:f,phone:b,price:calculateTotal(),notes:w},a=localStorage.getItem("token")||"demo-token",l=c.env.NEXT_PUBLIC_API_URL||"http://localhost:3001",s=await fetch("".concat(l,"/api/bookings"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify(r)});if(!s.ok){let e=await s.json();throw Error(e.error||"Falha ao agendar")}let i=await s.json();console.log("✅ Agendamento criado:",i),alert("✅ Agendamento realizado com sucesso!\nID: ".concat((null===(o=i.booking)||void 0===o?void 0:o.id)||"N/A")),u(null),m([]),p(""),g(""),x(""),N(""),t(1)}catch(e){console.error("❌ Erro ao processar agendamento:",e),alert("❌ Erro: ".concat(e.message||"Falha ao agendar. Tente novamente."))}finally{k(!1)}},calculateTotal=()=>d.reduce((e,t)=>e+(t.price||0),0);return(0,o.jsxs)("div",{className:"flex flex-col min-h-screen",children:[(0,o.jsx)(a.Z,{}),(0,o.jsxs)("main",{className:"flex-grow max-w-4xl mx-auto w-full px-4 py-8",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Agendar Servi\xe7o de Limpeza"}),(0,o.jsxs)("div",{className:"mb-8",children:[(0,o.jsx)("div",{className:"flex justify-between items-center mb-4",children:[1,2,3,4].map(t=>(0,o.jsx)("div",{className:"flex-1 h-2 mx-1 rounded transition ".concat(t<=e?"bg-blue-600":"bg-gray-300")},t))}),(0,o.jsxs)("p",{className:"text-center text-gray-600 font-semibold",children:["Passo ",e," de 4"]})]}),(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 mb-8",children:[1===e&&(0,o.jsx)(s.Z,{onDateSelected:u}),2===e&&(0,o.jsx)(i.Z,{onServiceSelected:m}),3===e&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-xl font-bold mb-6",children:"Localiza\xe7\xe3o e Detalhes"}),(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block font-semibold mb-2",children:"Telefone *"}),(0,o.jsx)("input",{type:"tel",value:b,onChange:e=>g(e.target.value),placeholder:"(11) 9999-9999",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block font-semibold mb-2",children:"Endere\xe7o Completo *"}),(0,o.jsx)("input",{type:"text",value:f,onChange:e=>p(e.target.value),placeholder:"Rua, n\xfamero, complemento, bairro, cidade",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block font-semibold mb-2",children:"CEP"}),(0,o.jsx)("input",{type:"text",value:h,onChange:e=>x(e.target.value),placeholder:"00000-000",className:"w-48 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block font-semibold mb-2",children:"Notas Adicionais"}),(0,o.jsx)("textarea",{value:w,onChange:e=>N(e.target.value),placeholder:"Informa\xe7\xf5es adicionais sobre o servi\xe7o...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-600",rows:"4"})]})]})]}),4===e&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{className:"text-xl font-bold mb-6",children:"Resumo do Agendamento"}),(0,o.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg space-y-3",children:[(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Data:"})," ",n]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Servi\xe7o:"})," ",d.map(e=>e.name).join(", ")]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Endere\xe7o:"})," ",f]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Telefone:"})," ",b]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Total:"})," R$ ",calculateTotal().toFixed(2)]})]})]})]}),(0,o.jsxs)("div",{className:"flex justify-between gap-4 mb-8",children:[(0,o.jsx)("button",{onClick:()=>{e>1&&t(e-1)},disabled:1===e,className:"px-6 py-3 border border-gray-300 rounded-lg font-semibold disabled:opacity-50",children:"Voltar"}),e<4?(0,o.jsx)("button",{onClick:()=>{e<4&&t(e+1)},className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700",children:"Pr\xf3ximo"}):(0,o.jsx)("button",{onClick:handleSubmit,disabled:_,className:"px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 disabled:opacity-50",children:_?"⏳ Agendando...":"✅ Confirmar Agendamento"})]})]}),(0,o.jsx)(l.Z,{})]})}},7663:function(e){!function(){var t={229:function(e){var t,n,o,r=e.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(e){if(t===setTimeout)return setTimeout(e,0);if((t===defaultSetTimout||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){t=defaultSetTimout}try{n="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){n=defaultClearTimeout}}();var a=[],l=!1,s=-1;function cleanUpNextTick(){l&&o&&(l=!1,o.length?a=o.concat(a):s=-1,a.length&&drainQueue())}function drainQueue(){if(!l){var e=runTimeout(cleanUpNextTick);l=!0;for(var t=a.length;t;){for(o=a,a=[];++s<t;)o&&o[s].run();s=-1,t=a.length}o=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===defaultClearTimeout||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new Item(e,t)),1!==a.length||l||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=noop,r.addListener=noop,r.once=noop,r.off=noop,r.removeListener=noop,r.removeAllListeners=noop,r.emit=noop,r.prependListener=noop,r.prependOnceListener=noop,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},n={};function __nccwpck_require__(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={exports:{}},a=!0;try{t[e](r,r.exports,__nccwpck_require__),a=!1}finally{a&&delete n[e]}return r.exports}__nccwpck_require__.ab="//";var o=__nccwpck_require__(229);e.exports=o}()}},function(e){e.O(0,[664,20,774,888,179],function(){return e(e.s=7909)}),_N_E=e.O()}]);